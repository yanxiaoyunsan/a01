!function(t,e){t.touch={init:function(){t.touch.setpjax(),t.touch.asynclist(),t.touch.ecjia_menu(),t.touch.selectbox(),t.touch.valid(),t.touch.toggle_collapse(),t.touch.close_app_download()},toast:function(t,o,a){var i=e('<div class="ecjia-toast '+(a||"")+'"><div>'+t+"</div></div>").appendTo(e(".con"));setTimeout(function(){i.remove()},o||2e3)},setpjax:function(){t.pjaxoption={timeout:1e4,push:!0,replace:!1,maxCacheLength:0,recordHistory:!1,container:".con",pjaxAnimation:"",cache:!1,storage:!1,titleSuffix:".pjax"},t.extend({pjax:function(o,a){var i=e.extend(t.pjaxoption,{url:o,callback:function(){"function"==typeof a&&a()}});e.pjax(i),delete t.pjaxoption.url}}),t.pjax.reload=function(){e.pjax.reload(t.pjaxoption.container,t.pjaxoption)},e.support.pjax?e(document).on("click","a:not(.nopjax)",function(o){var a=e(this).attr("data-rh")?1:0;t.pjaxoption.replaceHistory=a,e.pjax.click(o,t.pjaxoption.container,t.pjaxoption)}):(e.cookie("alertnopjax")||alert("您的浏览器不支持PJAX！升级浏览器即可加速网页浏览，减少流量损耗！"),e.cookie("alertnopjax",1))},pjaxloadding:function(){e("body").append('<div class="la-ball-atom"><div></div><div></div><div></div><div></div></div>')},showmessage:function(o){var a={message:!1,is_show:!0,state:"success",links:!1,close:!0,pjaxurl:""},o=e.extend({},a,o);o.message&&o.is_show&&alert(o.message),o.pjaxurl&&t.pjax(o.pjaxurl)},asynclist:function(){if(e('[data-toggle="asynclist"]').length){var o=e('[data-toggle="asynclist"]');options={areaSelect:'[data-toggle="asynclist"]',url:o.attr("data-url"),size:o.attr("data-size"),page:o.attr("data-page")},t.touch.more(options);var a=o.attr("data-loadimg")||!1;a&&($loader=e('<a class="load-list" href="javascript:;"><img src="'+a+'" /></a>'),o.after($loader))}},more:function(o){e(window).scrollTop(0);var a={url:!1,page:1,size:10,areaSelect:"#J_ItemList",scroll:!0,offset:100,trigger:".load-list",lock:!1},o=e.extend({},a,o),i=function(){!o.lock&&e(window).scrollTop()>e(document).height()-e(window).height()-o.offset&&(o.lock=!0,t.touch.load_list(o),o.page++)};if(i(),o.scroll)window.onscroll=function(){i()};else{var n='<button id="load_more_btn" class="btn btn-default btn-lg">点击加载更多</button>';e('[data-flag="add_load_more_btn"]').after(n),e("#load_more_btn").on("click",function(){i(),e(this).attr("data-scroll","false")})}},more_callback:function(){t.touch.delete_list_click()},load_list:function(o){return o.url?(e(o.trigger).show(),void e.get(o.url,{page:o.page,size:o.size},function(a){e(o.areaSelect).append(a.list),o.lock=a.is_last,e(o.trigger).hide(),1==a.is_last&&e("#load_more_btn").remove(),t.touch.more_callback()})):console.log("批量操作缺少参数！")},delete_list_click:function(){e(document).off("click",'[data-toggle="del_list"]'),e(document).on("click",'[data-toggle="del_list"]',function(){var o=e(this),a=o.attr("data-id"),i=o.attr("data-msg")?o.attr("data-msg"):"您确定要删除此条信息吗？",n=o.attr("data-url");a&&n&&confirm(i)&&t.touch.delete_list({id:a,url:n})})},delete_list:function(o){e.get(o.url,{id:o.id},function(e){t.touch.showmessage(e)},"json")},touch_slide:function(){TouchSlide({slideCell:"#picScroll",titCell:".hd ul",autoPage:"true",pnLoop:"false",switchLoad:"_src"})},region_change:function(){e('[data-toggle="region_change"]').on("change",function(){var o=e(this),a=o.attr("id"),i=o.attr("data-index")||"",n=o.attr("data-url"),c=o.attr("data-type"),l=o.attr("data-target"),s=o.val();0==e("#selCountries"+i).val()?(e("#selProvinces"+i).children("option:gt(0)").remove(),e("#selCities"+i).children("option:gt(0)").remove(),e("#selDistricts"+i).children("option:gt(0)").remove()):(a=="selCountries"+i||("selProvinces"==a?0==e("#selProvinces"+i).val()&&e("#selCities"+i).children("option:gt(0)").remove():"selCities"==a&&0==e("#selCities"+i).val()&&e("#selDistricts"+i).children("option:gt(0)").remove()),e.get(n,{type:c,target:l,parent:s},function(o){if("success"==o.state){for(var n="",c=0;c<o.regions.length;c++)n+='<option value="'+o.regions[c].region_id+'">'+o.regions[c].region_name+"</option>";a=="selCountries"+i?(e("#selProvinces"+i).children("option:gt(0)").remove(),e("#selProvinces"+i).children("option").after(n)):a=="selProvinces"+i?(e("#selCities"+i).children("option:gt(0)").remove(),e("#selCities"+i).children("option").after(n)):a=="selCities"+i&&(e("#selDistricts"+i).children("option:gt(0)").remove(),e("#selDistricts").show(),e("#selDistricts"+i).children("option").after(n))}else t.touch.showmessage(o)},"json"))})},ecjia_menu:function(){e(document).off("click",".ecjia-menu .main"),e(document).on("click",".ecjia-menu .main",function(){e(".ecjia-menu").hasClass("active")?e(".ecjia-menu").removeClass("active"):e(".ecjia-menu").addClass("active")})},toggle_collapse:function(){e(document).on("click",'[data-trigger="collapse"]',function(t){t.preventDefault();var o=e(this),a=o.attr("data-parent")?o.parents(o.attr("data-parent")):o,i=a.find(o.attr("href"))||o.next();a.hasClass("active")?a.addClass("active"):a.removeClass("active"),i.is(":visible")?i.hide():i.show()})},selectbox:function(){e(".ecjia-form select").each(function(t){var o=e(this),a=e('<div class="select"><i class="iconfont"></i></div>');o.after(a),a.append(o)})},valid:function(){var o=e(".ecjia-form");o.length&&o.each(function(o){var a="novalid"==e(this).attr("data-valid")?!1:!0;a&&e(this).on("submit",function(t){return t.preventDefault(),!1}).Validform({tiptype:4,ajaxPost:!0,callback:function(e){t.touch.showmessage(e)}})})},searchbox_foucs:function(){e("#keywordBox").focus()},close_app_download:function(){e(".ecjia-app-download .icon-close").on("click",function(){e.cookie("hide_download",1),e(".ecjia-app-download").remove()})}},e(document).on("pjax:complete",function(){window.onscroll=null,t.touch.asynclist(),t.touch.selectbox(),t.touch.valid(),t.touch.more_callback=function(){t.touch.delete_list_click()}}),e(document).on("pjax:start",function(){t.touch.pjaxloadding()}),e(document).on("pjax:popstate",function(){}),e(document).on("pjax:end",function(){e(".la-ball-atom").remove(),e(".ecjia-menu").hasClass("active")&&e(".ecjia-menu").removeClass("active")})}(ecjia,jQuery),$(function(){ecjia.touch.init()});