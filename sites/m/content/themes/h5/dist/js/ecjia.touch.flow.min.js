!function(e,t){e.touch.flow={init:function(){e.touch.flow.change_number_click(),e.touch.flow.selectShipping(),e.touch.flow.selectPayment(),e.touch.flow.change_need_inv(),e.touch.flow.change_bonus(),e.touch.flow.change_surplus(),e.touch.flow.change_integral(),e.touch.flow.select_inv(),e.touch.flow.select_attr(),e.touch.flow.fold_area(),e.touch.flow.check_goods(),t("body").winderCheck(),t('[data-toggle="selectPayment"]:checked').trigger("select"),t('[data-toggle="selectShipping"]:checked').trigger("select"),t('[data-toggle="change_bonus"]:checked').trigger("select"),t('[data-toggle="change_surplus"]:checked').blur(),t('[data-toggle="change_integral"]:checked').blur()},change_number_click:function(){t('[data-toggle="change_goods_number"]').on("click",function(){var a=t(this),n={rec_id:a.attr("data-rec_id"),url:a.attr("data-url"),status:a.attr("data-status")},c=t("#goods_number"+n.rec_id).val();"del"==n.status?1==c?c=1:(c=parseInt(c)-1,t("#goods_number"+n.rec_id).val(c)):(c=parseInt(c)+1,t("#goods_number"+n.rec_id).val(c)),e.touch.flow._change_goods(n,c)}),t('[data-toggle="change_goods_number_blur"]').on("blur",function(){var a=t(this),n={rec_id:a.attr("data-rec_id"),url:a.attr("data-url"),status:a.attr("data-status")},c=t("#goods_number"+n.rec_id).val();0>=c&&(c=1,t("#goods_number"+n.rec_id).val(1)),e.touch.flow._change_goods(n,c)})},_change_goods:function(e,a){t.post(e.url,{rec_id:e.rec_id,goods_number:a},function(a){"success"==a.state?(t("#total_number").html(a.total_number),t("#goods_subtotal").html(a.total_desc)):"1"==a.error&&(alert(a.message),t("#goods_number"+e.rec_id).val(a.err_max_number))},"json")},selectShipping:function(){t(document).off("click",'[data-toggle="selectShipping"]'),t(document).on("click",'[data-toggle="selectShipping"]',function(){var e=t(this),a=t(".hidden_rec_id").val(),n={shipping:e.val(),rec_id:a},c=e.attr("data-url");t.get(c,n,function(e){"success"==e.state?t("#total_number").html(e.content):"1"==e.error&&alert(e.message)})})},selectPayment:function(){t(document).off("click",'[data-toggle="selectPayment"]'),t(document).on("click",'[data-toggle="selectPayment"]',function(){var e=t(this),a=t(".hidden_rec_id").val(),n={payment:e.val(),rec_id:a},c=e.attr("data-url");t.get(c,n,function(e){"success"==e.state?(t("#total_number").html(e.total_number),t("#goods_subtotal").html(e.total_desc)):"1"==e.error&&(alert(e.message),t("#goods_number"+n.rec_id).val(e.err_max_number))})})},select_attr:function(){t(".flow-checkout .checkout-select label").on("click",function(){var e=t.trim(t(this).text());t(this).parents("div").prev("a").find(".select_nav").text(e)})},change_need_inv:function(){t('[data-toggle="click_need_inv"]').on("click",function(){var e=t(this),a=t(".hidden_rec_id").val(),n={need_inv:e.val(),rec_id:a},c=e.attr("data-url");t.get(c,n,function(e){"success"==e.state?(t("#total_number").html(e.total_number),t("#goods_subtotal").html(e.total_desc)):"1"==e.error&&(alert(e.message),t("#goods_number"+n.rec_id).val(e.err_max_number))})}),t('[data-toggle="change_need_inv"]').on("change",function(){var e=t(this),a={inv_type:e.val(),rec_id:rec_id},n=e.attr("data-url");t.get(n,a,function(e){"success"==e.state?(t("#total_number").html(e.total_number),t("#goods_subtotal").html(e.total_desc)):"1"==e.error&&(alert(e.message),t("#goods_number"+a.rec_id).val(e.err_max_number))})}),t('[data-toggle="blur_need_inv"]').on("blur",function(){var e=t(this),a={inv_payee:e.val(),rec_id:rec_id},n=e.attr("data-url");t.get(n,a,function(e){"success"==e.state?(t("#total_number").html(e.total_number),t("#goods_subtotal").html(e.total_desc)):"1"==e.error&&(alert(e.message),t("#goods_number"+a.rec_id).val(e.err_max_number))})})},change_bonus:function(){t('[data-toggle="change_bonus"]').on("click",function(){var e=t(this),a=t(".hidden_rec_id").val(),n={bonus:e.val(),rec_id:a},c=e.attr("data-url");t.get(c,n,function(e){"success"==e.state?t("#total_number").html(e.content):"1"==e.error&&(alert(e.message),t("#goods_number"+n.rec_id).val(e.err_max_number))})})},change_surplus:function(){t('[data-toggle="change_surplus"]').on("blur",function(){var e=t(this),a=t(".hidden_rec_id").val(),n={surplus:e.val(),rec_id:a},c=e.attr("data-url");t.get(c,n,function(e){"success"==e.state?t("#total_number").html(e.content):"1"==e.error&&(alert(e.message),t("#goods_number"+n.rec_id).val(e.err_max_number))})})},change_integral:function(){t('[data-toggle="change_integral"]').on("blur",function(){var e=t(this),a=t(".hidden_rec_id").val(),n={integral:e.val(),rec_id:a},c=e.attr("data-url");t.get(c,n,function(e){"success"==e.state?t("#total_number").html(e.message.content):"1"==e.error&&(alert(e.message),t("#goods_number"+n.rec_id).val(e.err_max_number))})})},select_inv:function(){t('[data-flag="need_inv_i"]').on("click",function(){t(this).hasClass("fl")?(t(this).removeClass("fl").addClass("fr"),t(this).siblings("ins").text("是"),t(this).parent().parent("li").siblings().hide()):t(this).hasClass("fr")&&(t(this).removeClass("fr").addClass("fl"),t(this).siblings("ins").text("否"),t(this).parent().parent("li").siblings().show())})},fold_area:function(){t(document).off("click",".flow-checkout .checkout-select .select"),t(document).on("click",".flow-checkout .checkout-select .select",function(e){e.preventDefault(),t(this).next().toggle()})},init_pay:function(){t('input[name="shipping"]:checked').val()||t('input[name="shipping"]').eq(0).prop("checked","true"),t('input[name="payment"]:checked').val()||t('input[name="payment"]').eq(0).prop("checked","true")},check_goods:function(){t(".checkbox").on("change",function(){var e=t(".checkbox:checked"),a=[],n=t(".goods-checkout").attr("data-url")+"&rec_id=";e.each(function(){a=t(this).val(),n=n+a+","}),n=n.substring(0,n.length-1),t(".goods-checkout").attr("href",n)})}}}(ecjia,jQuery);